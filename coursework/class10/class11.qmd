---
title: "Class 11: Comparative Structure Analysis"
author: "Christopher Leone | A16731724"
format: html
toc: true
title_block_banner: true
---

## (4) Comparative structure analysis of ADK

First, let's load up our packages that we will need for protein structure analysis.

```{r}
library(bio3d)
library(BiocGenerics)
```

We will analyze the ADK starting with a single ADK database accession code: "1AKE_A".

```{r}
# This first section will gather the sequence.
id <- "1ake_A"
aa <- get.seq(id)
aa

# Now, let's use the blast() function.
blast <- blast.pdb(aa)
```

Let's look at our hits!

```{r}
# Here is our blast table of results...
hits <- head(blast$hit.tbl, 18)

# And let's make a plot!
plot(blast)

# Finally, our top matches:
hits$pdb.id
```

Now, I want to take those top 18 hits and download their files into a subfolder in the project directory. We can do that with `files()`.

```{r}
# Download releated PDB files
files <- get.pdb(hits$pdb.id, path="pdbs", split=TRUE, gzip=TRUE)
```

Let's align and superpose all of these structures to see what we can analyze:

```{r}
# Align releated PDBs
pdbs <- pdbaln(files, fit = TRUE, exefile="msa")

# Let's look at our superposed structures:
library(bio3dview)
view.pdbs(pdbs)
```

This is much better than what we can see in **MolStar**, but it's still quite difficult to see what is similar or different between all of these structures.

```{r}
# Finally, let's do our PCA analysis.
pc <- pca(pdbs)
plot(pc)

# Let's view:
view.pca(pc)
```

Now, if I wanted to view these in **MolStar**, I would have to read these into a file:

```{r}
mktrj(pc, file="pca_results.pdb")
```

